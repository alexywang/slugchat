(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{112:function(e,t,n){e.exports=n(286)},117:function(e,t,n){},118:function(e,t,n){e.exports=n.p+"static/media/logo.ee7cd8ed.svg"},119:function(e,t,n){},146:function(e,t){},149:function(e,t,n){},286:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(111),s=n.n(i),r=(n(117),n(21)),c=n(7),l=n(8),m=n(10),u=n(9),h=n(2),d=n(11),v=(n(118),n(119),n(17)),p=n.n(v),g=(n(149),n(150),function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(m.a)(this,Object(u.a)(t).call(this,e))).state={messages:[],typers:[],myHandle:"",myMessage:"",endpoint:"/"},n.onMessageReceived=n.onMessageReceived.bind(Object(h.a)(n)),n.onTypingReceived=n.onTypingReceived.bind(Object(h.a)(n)),n.onHandleBoxChange=n.onHandleBoxChange.bind(Object(h.a)(n)),n.onMessageBoxChange=n.onMessageBoxChange.bind(Object(h.a)(n)),n.onMessageBoxSubmit=n.onMessageBoxSubmit.bind(Object(h.a)(n)),n.leaveAndDisconnect=n.leaveAndDisconnect.bind(Object(h.a)(n)),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"onMessageReceived",value:function(e){var t=this.state.messages,n=[].concat(Object(r.a)(t),[e]);this.setState({messages:n});var a=this.state.typers.filter(function(t){return e.handle!==t});this.setState({typers:a})}},{key:"onTypingReceived",value:function(e){var t=this.state.typers,n=-1===t.indexOf(e)?[].concat(Object(r.a)(t),[e]):t;this.setState({typers:n})}},{key:"onHandleBoxChange",value:function(e){this.setState({myHandle:e.target.value})}},{key:"onMessageBoxChange",value:function(e){var t=this.state.myHandle,n=this.props.room;this.chatSocket.emit("typing",{roomid:n.id,typer:t}),this.setState({myMessage:e.target.value})}},{key:"onMessageBoxSubmit",value:function(e){var t=this.state,n=t.myHandle,a=t.myMessage,o=this.props,i=o.room,s=o.user;0!==a.length&&0!==n.length&&(this.chatSocket.emit("message",{roomid:i.id,text:a,handle:s.name+"@"+n}),this.setState({myMessage:""})),e.preventDefault()}},{key:"leaveAndDisconnect",value:function(){var e=this.props;(0,e.onLeaveRoom)(e.room),this.chatSocket.disconnect()}},{key:"componentDidMount",value:function(){var e=this,t=this.state.endpoint,n=this.props,a=n.room,o=n.user;this.chatSocket=p()(t+"/chats"),this.chatSocket.emit("joinRoom",{roomid:a.id,user:o}),this.chatSocket.on("joinRoom",function(e){e.user}),this.chatSocket.on("message",function(t){e.onMessageReceived(t)}),this.chatSocket.on("typing",function(t){e.onTypingReceived(t)}),this.setState({messages:a.messages}),window.addEventListener("beforeunload",function(t){console.log("unloading"),e.chatSocket.emit("unloading",{room:e.room.id,user:e.user})})}},{key:"render",value:function(){var e=this.state,t=e.messages,n=e.typers,a=e.myHandle,i=e.myMessage,s=this.props.room;return o.a.createElement("div",{className:"Chat"},o.a.createElement(C,{onClick:this.leaveAndDisconnect},"X"),o.a.createElement("center",null,o.a.createElement("h1",null,s.name)),o.a.createElement(b,{messages:t}),o.a.createElement(E,{list:n}),o.a.createElement(y,{value:a,onChange:this.onHandleBoxChange}),o.a.createElement(f,{value:i,onChange:this.onMessageBoxChange,onSubmit:this.onMessageBoxSubmit},"Send "))}}]),t}(a.Component)),b=function(e){function t(){return Object(c.a)(this,t),Object(m.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.messages;return o.a.createElement("div",{className:"MessageDisplay"},e.map(function(e){return o.a.createElement("div",{key:e.handle+" "+e.text,id:"message"},o.a.createElement("p",null," ",o.a.createElement("span",{id:"messageHandle"},e.handle,": ")," ",o.a.createElement("span",{id:"messageText"},e.text)," "))}))}}]),t}(a.Component),f=function(e){var t=e.value,n=e.onChange,a=e.onSubmit,i=e.children;return o.a.createElement("form",{className:"MessageBox",onSubmit:a},o.a.createElement("input",{type:"text",onChange:n,value:t,placeholder:"Message"}),o.a.createElement("button",{type:"submit"},i))},y=function(e){var t=e.value,n=e.onChange,a=e.children;return o.a.createElement("input",{type:"text",className:"HandleBox",onChange:n,value:t,placeholder:"Handle"},a)},E=function(e){var t=e.list,n=t.length>1?"are":"is";return o.a.createElement("div",{className:"DynamicList"},o.a.createElement("p",null,t.length>0?function(e){var t="";if(0===e.length)return"";for(var n=0;n<e.length-1;n++)t+="".concat(e[n],", ");return t+=e[e.length-1]}(t)+" ".concat(n," typing..."):""))},C=function(e){var t=e.onClick,n=e.children;return o.a.createElement("button",{onClick:t},n)},R=g,j=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(m.a)(this,Object(u.a)(t).call(this,e))).state={rooms:[],endpoint:"/"},n.onCreateRoom=n.onCreateRoom.bind(Object(h.a)(n)),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"onCreateRoom",value:function(e,t,n){if(e.preventDefault(),t&&n){(n>100||n<2)&&window.alert("Capacity must be between 2 and 100"),console.log(t),console.log(n);var a=this.props.onRoomJoin;this.chatSocket.emit("createRoom",{name:t,capacity:n}),this.chatSocket.on("newRoomReady",function(e){a(e)})}}},{key:"componentDidMount",value:function(){var e=this,t=this.state.endpoint;this.lobbySocket=p()(t+"/lobby"),this.chatSocket=p()(t+"/chats"),this.lobbySocket.on("roomList",function(t){console.log("Receiving room list..."),e.setState({rooms:t})})}},{key:"render",value:function(){var e=this.props.onRoomJoin;return o.a.createElement("div",{className:"Lobby"},o.a.createElement(k,{rooms:this.state.rooms,onRoomJoin:e}),o.a.createElement(x,{onCreateRoom:this.onCreateRoom},"Create Room"))}}]),t}(a.Component),k=function(e){var t=e.rooms,n=e.onRoomJoin;return o.a.createElement("div",{className:"RoomList"},t.map(function(e){return o.a.createElement(S,{key:e.id,room:e,onRoomJoin:function(){return n(e)}},"Join")}))},S=function(e){var t=e.room,n=e.onRoomJoin,a=e.children,i=t.name,s=t.capacity,r=t.users,c=r.map(function(e){return e.name}),l=r.length>=s?{backgroundColor:"red"}:{backgroundColor:"green"};return o.a.createElement("div",{className:"Room"},o.a.createElement("span",{id:"title"},i),o.a.createElement("button",{id:"join",onClick:n},a),o.a.createElement("span",{id:"userlist"},o.a.createElement(O,{list:c},o.a.createElement("span",{id:"capacity",style:l},"".concat(r.length,"/").concat(s)))))},O=function(e){var t=e.list,n=e.children,a=0;return o.a.createElement("div",{className:"HoverList"},o.a.createElement("div",{className:"HoverHitbox"},n),o.a.createElement("div",{className:"HoverContent"},t.map(function(e){return o.a.createElement("li",{key:a++},e)})))},x=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(m.a)(this,Object(u.a)(t).call(this,e))).state={name:"",capacity:void 0},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.onCreateRoom,a=t.children,i=this.state,s=i.name,r=i.capacity;return o.a.createElement("div",{className:"CreateRoom"},o.a.createElement("form",{onSubmit:function(e){return n(e,s,r)}},o.a.createElement("input",{type:"text",onChange:function(t){e.setState({name:t.target.value})},value:s,placeholder:"Chat Room Name"}),o.a.createElement("input",{type:"number",onChange:function(t){e.setState({capacity:t.target.value})},value:r,placeholder:"Capacity"}),o.a.createElement("button",{type:"submit"},a)))}}]),t}(a.Component),M=j,w=(n(17),function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(m.a)(this,Object(u.a)(t).call(this,e))).state={joinedRooms:[],user:{name:"",id:""+Math.random()},usernameInput:""},n.addRoom=n.addRoom.bind(Object(h.a)(n)),n.leaveRoom=n.leaveRoom.bind(Object(h.a)(n)),n.onUsernameSubmit=n.onUsernameSubmit.bind(Object(h.a)(n)),n.onUsernameChange=n.onUsernameChange.bind(Object(h.a)(n)),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"onUsernameSubmit",value:function(e){e.preventDefault();var t={name:this.state.usernameInput,id:this.state.user.id};this.setState({user:t})}},{key:"onUsernameChange",value:function(e){this.setState({usernameInput:e.target.value})}},{key:"addRoom",value:function(e){this.state.user;var t=this.state.joinedRooms;if(!t.find(function(t){return t.id===e.id}))if(e.users.length<e.capacity){console.log("Adding a new chat.");var n=[].concat(Object(r.a)(t),[e]);this.setState({joinedRooms:n})}else console.log("Room was full.")}},{key:"leaveRoom",value:function(e){var t=this.state.joinedRooms.filter(function(t){return t.id!==e.id});this.setState({joinedRooms:t})}},{key:"renderChat",value:function(e){var t=this.state.user;return o.a.createElement("div",{key:e.id,className:"grid-item"},o.a.createElement("div",null,o.a.createElement(R,{room:e,user:t,onLeaveRoom:this.leaveRoom})))}},{key:"renderAllChats",value:function(){var e=this,t=this.state.joinedRooms;return o.a.createElement("div",{className:"AllChats"},t.map(function(t){return e.renderChat(t)}))}},{key:"render",value:function(){return this.state.user.name?o.a.createElement("div",{className:"ChatGrid"},o.a.createElement("div",{className:"grid-item"},o.a.createElement(M,{onRoomJoin:this.addRoom})),this.renderAllChats()):o.a.createElement("div",{className:"usernamePrompt"},o.a.createElement(N,{onSubmit:this.onUsernameSubmit,onChange:this.onUsernameChange,placeholder:"Choose your display name"},"Set Username"))}}]),t}(a.Component)),N=function(e){var t=e.onSubmit,n=e.onChange,a=e.placeholder,i=e.children;return o.a.createElement("form",{className:"TextInput",onSubmit:t},o.a.createElement("input",{type:"text",placeholder:a,onChange:n}),o.a.createElement("button",{type:"submit"},i))},B=w;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(B,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[112,1,2]]]);
//# sourceMappingURL=main.7d6f6ae2.chunk.js.map